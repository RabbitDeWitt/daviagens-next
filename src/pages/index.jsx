import Head from 'next/head'
import { Carousel, DestinationCard, PromotionCard } from '@/components'
// import { listaDestinos } from '@/constants/data'
import { useEffect, useState } from 'react'
import { useDestinos } from '@/hooks'
import { useAppContext } from '@/context/appContext'

export default function Home() {
  const { listarDestinos } = useDestinos()

  const { destinos } = useAppContext()

  const [carouselDestinos, setCarouselDestinos] = useState([])
  const [promocoes, setPromocoes] = useState([])
  const [teste, setTeste] = useState([])

  useEffect(() => {
    listarDestinos()
  }, [])


  useEffect(() => {
    const tamArray = destinos.length || 11

    let numeros = []
    while (numeros.length < 7) {
      let num = Math.ceil(Math.random() * tamArray)
      if (numeros.indexOf(num) === -1) numeros.push(num)
    }

    setCarouselDestinos(destinos.filter((destino) => destino.id === numeros[0] || destino.id === numeros[1] || destino.id === numeros[2]))
    setTeste(destinos.filter((destino) => destino.id === numeros[3] || destino.id === numeros[4]))
    setPromocoes(destinos.filter((destino) => destino.id === numeros[5] || destino.id === numeros[6]))

  }, [destinos])




  return (
    <>
      <Head>
        <title>Daviagens</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main>

        <Carousel carouselDestinos={carouselDestinos} />


        <section className="container my-5 d-flex gap-5 " id="destinos">

          <div className="destinos-description d-flex flex-column justify-content-evenly align-items-start">
            <h2>Destinos</h2>
            <p>
              Explore os destinos mais deslumbrantes do mundo com a nossa agência de viagens. De paisagens exuberantes a
              culturas
              fascinantes, viva experiências únicas que ficarão gravadas em sua alma para sempre!
            </p>
            <a className="btn btn-primary" href="/destinos">Ver mais destinos</a>
          </div>

          <div className="card-section d-flex gap-3">


            {teste.map((destino, i) => (
              <DestinationCard
                key={i}
                destino={destino} />
            ))}
          </div>

        </section>

        <section className="container d-flex flex-row-reverse gap-5" id="promocoes">

          <div className="promocoes-description d-flex flex-column justify-content-evenly align-items-end ">
            <h2>Promoções</h2>
            <p>
              Descubra o mundo com nossas imperdíveis promoções de viagens! Aventure-se em destinos fascinantes e crie
              memórias
              inesquecíveis, enquanto aproveita descontos exclusivos para viver experiências únicas pelo globo.
            </p>
            <a className="btn btn-primary" href="/promocoes">Ver mais promoções</a>
          </div>

          <div className="card-section d-flex gap-3">
            {promocoes.map((promocao, i) => (
              <PromotionCard
                key={i}
                destino={promocao} />
            ))}
          </div>
        </section>


      </main>
    </>
  )
}
